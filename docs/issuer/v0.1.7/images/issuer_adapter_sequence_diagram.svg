<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1026px" preserveAspectRatio="none" style="width:2113px;height:1026px;" version="1.1" viewBox="0 0 2113 1026" width="2113px" zoomAndPan="magnify"><defs><filter height="300%" id="fjguuuzsf36f1" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1011.5234" style="stroke: #A80036; stroke-width: 1.0;" width="892" x="813" y="4"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="1203" y="16.0669">Issuer Adapter</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="63" x2="63" y1="86.2969" y2="154.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="63" x2="63" y1="154.5625" y2="195.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63" x2="63" y1="195.3672" y2="603.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="63" x2="63" y1="603.2266" y2="644.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63" x2="63" y1="644.0313" y2="929.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246.5" x2="246.5" y1="86.2969" y2="154.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="246.5" x2="246.5" y1="154.5625" y2="195.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246.5" x2="246.5" y1="195.3672" y2="603.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="246.5" x2="246.5" y1="603.2266" y2="644.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="246.5" x2="246.5" y1="644.0313" y2="929.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="911" y1="86.2969" y2="154.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="911" x2="911" y1="154.5625" y2="195.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="911" y1="195.3672" y2="603.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="911" x2="911" y1="603.2266" y2="644.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="911" y1="644.0313" y2="929.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632" x2="1632" y1="86.2969" y2="154.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1632" x2="1632" y1="154.5625" y2="195.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632" x2="1632" y1="195.3672" y2="603.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="1632" x2="1632" y1="603.2266" y2="644.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632" x2="1632" y1="644.0313" y2="929.2266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2068.5" x2="2068.5" y1="86.2969" y2="154.5625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="2068.5" x2="2068.5" y1="154.5625" y2="195.3672"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2068.5" x2="2068.5" y1="195.3672" y2="603.2266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="2068.5" x2="2068.5" y1="603.2266" y2="644.0313"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="2068.5" x2="2068.5" y1="644.0313" y2="929.2266"/><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="8" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="15" y="70.9951">relying party</text><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="106" x="8" y="928.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="92" x="15" y="948.2217">relying party</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="205.5" y="82.9951">user wallet</text><ellipse cx="247" cy="13" fill="#FEFECE" filter="url(#fjguuuzsf36f1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M247,21 L247,48 M234,29 L260,29 M247,48 L234,63 M247,48 L260,63 " fill="none" filter="url(#fjguuuzsf36f1)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="77" x="205.5" y="941.2217">user wallet</text><ellipse cx="247" cy="954.5234" fill="#FEFECE" filter="url(#fjguuuzsf36f1)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M247,962.5234 L247,989.5234 M234,970.5234 L260,970.5234 M247,989.5234 L234,1004.5234 M247,989.5234 L260,1004.5234 " fill="none" filter="url(#fjguuuzsf36f1)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="817" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="824" y="70.9951">Issuer Adapter backend</text><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="184" x="817" y="928.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="170" x="824" y="948.2217">Issuer Adapter backend</text><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="1563" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="1570" y="70.9951">Issuer Adapter ui</text><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="134" x="1563" y="928.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="120" x="1570" y="948.2217">Issuer Adapter ui</text><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="2039.5" y="51"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="2046.5" y="70.9951">Issuer</text><rect fill="#FEFECE" filter="url(#fjguuuzsf36f1)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="55" x="2039.5" y="928.2266"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="41" x="2046.5" y="948.2217">Issuer</text><polygon fill="#A80036" points="922,113.4297,912,117.4297,922,121.4297,918,117.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="2068" y1="117.4297" y2="117.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="928" y="112.3638">Create profile HTTP POST /profile</text><polygon fill="#A80036" points="2057,142.5625,2067,146.5625,2057,150.5625,2061,146.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="2063" y1="146.5625" y2="146.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="918" y="141.4966">Response HTTP 201</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="325" x="903.5" y="178.7729">some time later, when user wants to connect with issuer</text><polygon fill="#A80036" points="922,212.5,912,216.5,922,220.5,918,216.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="2068" y1="216.5" y2="216.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="448" x="928" y="211.4341">Wallet Connect HTTP Redirect /&lt;issuerID&gt;/connect/wallet?state=&lt;id&gt;</text><polygon fill="#A80036" points="2057,241.6328,2067,245.6328,2057,249.6328,2061,245.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="2063" y1="245.6328" y2="245.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="312" x="918" y="240.5669">Get token for the state POST &lt;issuerURL&gt;/token</text><polygon fill="#A80036" points="922,270.7656,912,274.7656,922,278.7656,918,274.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="2068" y1="274.7656" y2="274.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="928" y="269.6997">Response HTTP 200 with token</text><polygon fill="#A80036" points="1620,299.8984,1630,303.8984,1620,307.8984,1624,303.8984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="1626" y1="303.8984" y2="303.8984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="120" x="918" y="298.8325">Redirect with txnid</text><polygon fill="#A80036" points="922,329.0313,912,333.0313,922,337.0313,918,333.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="1631" y1="333.0313" y2="333.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="304" x="928" y="327.9653">GET /issuer/didcomm/invitation?txnID=&lt;txnID&gt;</text><polygon fill="#A80036" points="2057,358.1641,2067,362.1641,2057,366.1641,2061,362.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="2063" y1="362.1641" y2="362.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="469" x="918" y="357.0981">Get user data if profile supports assurance HTTP POST &lt;issuerURL&gt;/data</text><polygon fill="#A80036" points="922,387.2969,912,391.2969,922,395.2969,918,391.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="2068" y1="391.2969" y2="391.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="224" x="928" y="386.231">Response HTTP 200 with user data</text><polygon fill="#A80036" points="1620,416.4297,1630,420.4297,1620,424.4297,1624,420.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="1626" y1="420.4297" y2="420.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="697" x="918" y="415.3638">CHAPI Request - didcomm invitation + manifest vc + governance vc + user vc (if issuer supports assurance)</text><polygon fill="#A80036" points="258,445.5625,248,449.5625,258,453.5625,254,449.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="1631" y1="449.5625" y2="449.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="91" x="264" y="444.4966">CHAPI request</text><polygon fill="#A80036" points="258,474.6953,248,478.6953,258,482.6953,254,478.6953" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="899,474.6953,909,478.6953,899,482.6953,903,478.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="905" y1="478.6953" y2="478.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="87" x="264" y="473.6294">did-exchange</text><polygon fill="#A80036" points="1620,503.8281,1630,507.8281,1620,511.8281,1624,507.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247" x2="1626" y1="507.8281" y2="507.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="254" y="502.7622">CHAPI response</text><polygon fill="#A80036" points="922,532.9609,912,536.9609,922,540.9609,918,536.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="1631" y1="536.9609" y2="536.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="253" x="928" y="531.895">POST /connect/validate?txnID=&lt;txnID&gt;</text><polygon fill="#A80036" points="1620,562.0938,1630,566.0938,1620,570.0938,1624,566.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="1626" y1="566.0938" y2="566.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="376" x="918" y="561.0278">Validate response, if successful, gives back the redirect url</text><polygon fill="#A80036" points="2057,591.2266,2067,595.2266,2057,599.2266,2061,595.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="1632" x2="2063" y1="595.2266" y2="595.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="413" x="1639" y="590.1606">Redirect to issuer HTTP Redirect &lt;issuerURL&gt;/cb?state={state}</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="234" x="949" y="627.437">some time later, user approaches the RP</text><polygon fill="#A80036" points="235,661.1641,245,665.1641,235,669.1641,239,665.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63" x2="241" y1="665.1641" y2="665.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="70" y="660.0981">Asks for credentials</text><polygon fill="#A80036" points="899,690.2969,909,694.2969,899,698.2969,903,694.2969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247" x2="905" y1="694.2969" y2="694.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="442" x="254" y="689.231">request-credential (attachment: User peer DID and RP peer DID Doc)</text><polygon fill="#A80036" points="258,719.4297,248,723.4297,258,727.4297,254,723.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="252" x2="910" y1="723.4297" y2="723.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="640" x="264" y="718.3638">issue-credential (AuthorizationCredential - User peer DID, RP peer DID Doc and Issuer peer DID Doc)</text><polygon fill="#A80036" points="74,748.5625,64,752.5625,74,756.5625,70,752.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="246" y1="752.5625" y2="752.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="80" y="747.4966">credential response to rp</text><polygon fill="#A80036" points="899,777.6953,909,781.6953,899,785.6953,903,781.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="63" x2="905" y1="781.6953" y2="781.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="444" x="70" y="776.6294">request-presentation (AuthorizationCredential - received from wallet)</text><polygon fill="#A80036" points="2057,806.8281,2067,810.8281,2057,814.8281,2061,810.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="2063" y1="810.8281" y2="810.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="788" x="918" y="805.7622">Get assurance data if profile supports assurance HTTP POST &lt;issuerURL&gt;/assurance, else get user data &lt;issuerURL&gt;/data</text><polygon fill="#A80036" points="922,835.9609,912,839.9609,922,843.9609,918,839.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="916" x2="2068" y1="839.9609" y2="839.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="928" y="834.895">Response HTTP 200</text><line style="stroke: #A80036; stroke-width: 1.0;" x1="911" x2="953" y1="869.0938" y2="869.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="953" x2="953" y1="869.0938" y2="882.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="912" x2="953" y1="882.0938" y2="882.0938"/><polygon fill="#A80036" points="922,878.0938,912,882.0938,922,886.0938,918,882.0938" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="918" y="864.0278">Create presentation</text><polygon fill="#A80036" points="74,907.2266,64,911.2266,74,915.2266,70,911.2266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="68" x2="910" y1="911.2266" y2="911.2266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="81" x="80" y="906.1606">presentation</text><!--MD5=[86e76e8c679b40c59d4076667949ce9e]
@startuml
participant "relying party" as rp
actor "user wallet" as wallet
box "Issuer Adapter"
participant iadapter as "Issuer Adapter backend"
participant iadapterui as "Issuer Adapter ui"
end box
participant Issuer as issuer

issuer -> iadapter : Create profile HTTP POST /profile
iadapter -> issuer : Response HTTP 201
...some time later, when user wants to connect with issuer...
issuer -> iadapter : Wallet Connect HTTP Redirect /<issuerID>/connect/wallet?state=<id>
iadapter -> issuer : Get token for the state POST <issuerURL>/token
issuer -> iadapter : Response HTTP 200 with token
iadapter -> iadapterui : Redirect with txnid
iadapterui -> iadapter : GET /issuer/didcomm/invitation?txnID=<txnID>
iadapter -> issuer : Get user data if profile supports assurance HTTP POST <issuerURL>/data
issuer -> iadapter : Response HTTP 200 with user data
iadapter -> iadapterui : CHAPI Request - didcomm invitation + manifest vc + governance vc + user vc (if issuer supports assurance)
iadapterui -> wallet : CHAPI request
wallet <-> iadapter : did-exchange
wallet -> iadapterui : CHAPI response
iadapterui -> iadapter : POST /connect/validate?txnID=<txnID>
iadapter -> iadapterui : Validate response, if successful, gives back the redirect url
iadapterui -> issuer : Redirect to issuer HTTP Redirect <issuerURL>/cb?state={state}
...some time later, user approaches the RP...
rp -> wallet : Asks for credentials
wallet -> iadapter : request-credential (attachment: User peer DID and RP peer DID Doc)
iadapter -> wallet : issue-credential (AuthorizationCredential - User peer DID, RP peer DID Doc and Issuer peer DID Doc)
wallet -> rp : credential response to rp
rp -> iadapter : request-presentation (AuthorizationCredential - received from wallet)
iadapter -> issuer : Get assurance data if profile supports assurance HTTP POST <issuerURL>/assurance, else get user data <issuerURL>/data
issuer -> iadapter : Response HTTP 200
iadapter -> iadapter : Create presentation
iadapter -> rp : presentation
@enduml

PlantUML version 1.2020.17beta5(Unknown compile time)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>